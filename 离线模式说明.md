# 离线模式说明

## 什么是离线模式？

当应用无法连接到 Firebase 云端服务时，会自动启用离线模式。在此模式下，应用将使用浏览器本地存储来保存数据。

## 启用条件

应用会在以下情况自动启用离线模式：

1. ❌ Firebase 网络连接超时（5秒）
2. ❌ Firebase 认证服务不可访问
3. ❌ 网络环境无法访问 Google 服务

## 功能对比

### ✅ 离线模式可用功能

- ✅ 添加、编辑、删除课时记录
- ✅ 管理学生和班级信息
- ✅ 查看统计数据（总工资、总课时等）
- ✅ 导出 Excel 表格
- ✅ 按月份筛选和预览
- ✅ 数据自动保存在浏览器本地存储

### ❌ 离线模式不可用功能

- ❌ 跨设备数据同步
- ❌ 多设备实时同步
- ❌ 账号登录/注册
- ❌ 云端数据备份

## 数据安全

### 数据保存位置
- 数据保存在浏览器的 localStorage 中
- 位置：当前浏览器的本地存储
- 容量限制：通常为 5-10MB

### 数据持久性
✅ 只要不清除浏览器数据，数据会一直保存
❌ 清除浏览器数据会导致数据丢失
❌ 卸载浏览器或重装系统可能导致数据丢失

### 备份建议
📌 **强烈建议定期导出 Excel 备份数据！**

1. 点击"导出Excel"按钮
2. 选择要导出的月份（或不选择导出所有数据）
3. 保存 Excel 文件到安全的位置
4. 建议每周或每月备份一次

## 从离线模式切换到云同步

如果你想使用云同步功能：

1. **确保网络可以访问 Firebase**
   - 可能需要使用 VPN 或代理
   - 确保网络防火墙没有阻止 Google 服务

2. **刷新页面**
   - 按 Ctrl + F5 强制刷新
   - 如果网络正常，会自动连接到 Firebase

3. **注册账号**
   - 输入邮箱和密码注册
   - 本地数据会自动上传到云端

4. **在其他设备登录**
   - 使用相同的账号密码
   - 数据会自动同步

## 常见问题

### Q: 离线模式安全吗？
A: 数据保存在本地浏览器中，只有你能访问。但请注意定期备份，防止数据丢失。

### Q: 可以在多台电脑上使用吗？
A: 离线模式下数据不会同步。每台电脑的数据是独立的，需要手动导出/导入 Excel 来转移数据。

### Q: 如何在设备间迁移数据？
A: 
1. 在原设备导出 Excel
2. 在新设备打开应用
3. 手动录入数据，或使用 Excel 作为参考

### Q: 离线模式的数据会丢失吗？
A: 只要不清除浏览器数据，数据会一直保存。但为了安全，建议定期导出 Excel 备份。

### Q: 如何关闭离线模式？
A: 离线模式无法手动关闭。当网络环境允许访问 Firebase 时，刷新页面即可自动连接云端。

## 技术说明

### 存储方式
```
localStorage['teacherSalaryRecords'] - 课时记录
localStorage['teacherStudents'] - 学生信息
localStorage['teacherClasses'] - 班级信息
```

### 数据格式
所有数据以 JSON 格式存储在 localStorage 中，可通过浏览器开发者工具查看。

## 总结

离线模式是为网络受限环境设计的备用方案：

✅ **优点**
- 无需网络即可使用
- 响应速度快
- 数据完全在本地，更私密

❌ **缺点**
- 无法跨设备同步
- 数据丢失风险较高
- 需要手动备份

**💡 建议**：如果可能，尽量使用云同步模式以获得最佳体验。
